/* Bottom-right pill - complete replacement */
#chat-pruner-pill {
  position: fixed;
  right: 12px; /* default; JS will override with stored position */
  bottom: 12px;
  min-width: 120px;
  height: 32px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0 12px;
  font: 600 12px/1.1 system-ui, -apple-system, Segoe UI, Roboto, sans-serif;

  /* Dark theme for strong contrast */
  --pill-bg: rgba(20,24,28,0.92);
  --pill-fg: #ffffff;
  --pill-border: rgba(255,255,255,0.18);
  background: var(--pill-bg);
  color: var(--pill-fg);
  border: 1px solid var(--pill-border);
  border-radius: 999px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.35);

  z-index: 2147483647;
  cursor: pointer;
  user-select: none;
  pointer-events: auto !important; /* Force clickability */

  /* Prevent resizing */
  overflow: hidden;
  resize: none;
  box-sizing: border-box;
  white-space: nowrap;
  
  /* Transitions for smooth interactions */
  transition: filter 0.15s ease, box-shadow 0.15s ease;
}

/* Light mode override if needed */
html[data-theme="light"] #chat-pruner-pill,
.light #chat-pruner-pill {
  --pill-bg: rgba(20,24,28,0.95); /* Keep dark for contrast */
  --pill-fg: #ffffff;
  --pill-border: rgba(255,255,255,0.25);
}

/* Dark mode (redundant but explicit) */
html[data-theme="dark"] #chat-pruner-pill,
.dark #chat-pruner-pill {
  --pill-bg: rgba(20,24,28,0.92);
  --pill-fg: #ffffff;
  --pill-border: rgba(255,255,255,0.18);
}

/* Dragging state */
#chat-pruner-pill[data-dragging="true"] {
  cursor: move !important;
  box-shadow: 0 8px 28px rgba(0,0,0,0.5), 0 0 0 2px rgba(255,255,255,0.08) inset;
  filter: brightness(1.1);
}

/* Text inside pill */
#chat-pruner-pill .pill-text {
  opacity: 0.95;
  color: inherit;
  pointer-events: none; /* Let clicks pass through to parent */
}

/* Subtle hover effect */
#chat-pruner-pill:not([data-dragging="true"]):hover {
  filter: brightness(1.05);
}

/* Alt key held (shows move intent) */
#chat-pruner-pill[data-alt-held="true"] {
  cursor: move;
  box-shadow: 0 8px 24px rgba(0,0,0,0.4), 0 0 0 1px rgba(255,255,255,0.1) inset;
}

/* Remove all old pill styles that might interfere */
#chat-pruner-pill::after {
  display: none; /* Remove any tooltip that might block clicks */
}

/* Hidden archive - keep as is */
#chat-pruner-hidden-archive {
  display: none !important;
}

/* Keep existing animation styles */
@keyframes chatPrunerCollapse {
  from {
    opacity: 1;
    max-height: var(--chat-height);
    margin-top: var(--chat-margin);
    margin-bottom: var(--chat-margin);
  }
  to {
    opacity: 0;
    max-height: 0;
    margin-top: 0;
    margin-bottom: 0;
  }
}

@keyframes chatPrunerExpand {
  0% {
    opacity: 0;
    max-height: 0;
    margin-top: 0;
    margin-bottom: 0;
    transform: translateY(-10px);
  }
  50% {
    opacity: 0.5;
    max-height: var(--chat-height);
    margin-top: var(--chat-margin);
    margin-bottom: var(--chat-margin);
    transform: translateY(-5px);
  }
  100% {
    opacity: 1;
    max-height: var(--chat-height);
    margin-top: var(--chat-margin);
    margin-bottom: var(--chat-margin);
    transform: translateY(0);
  }
}

.chat-pruner-collapsing {
  animation: chatPrunerCollapse 0.3s ease-out forwards;
  overflow: hidden;
  will-change: max-height, opacity, margin;
}

.chat-pruner-expanding {
  animation: chatPrunerExpand 0.3s ease-out forwards;
  overflow: hidden;
  will-change: max-height, opacity, margin;
}